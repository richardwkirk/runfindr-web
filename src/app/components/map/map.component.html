<div class="container-fluid">
    <agm-map (mapReady)="mapReady($event)" [latitude]="initialLatitude" [longitude]="initialLongitude" [zoom]="initialZoom" [fitBounds]="bounds" >
      <agm-marker 
          [latitude]="mappedEvent.event.location.lat" 
          [longitude]="mappedEvent.event.location.long" 
          [iconUrl]="mappedEvent.iconUrl" 
          [title]="mappedEvent.event.name"
          [zIndex]="mappedEvent.priority"
          [label]="mappedEvent.label"
          (markerClick)="eventSelected(mappedEvent)"
          *ngFor="let mappedEvent of this.mappedEvents">
        <agm-info-window>
          <div>
            <p><i>{{mappedEvent.event.longName}}</i></p>
            <p>{{mappedEvent.event.locationName}}</p>
            <li *ngFor="let visitorPair of mappedEvent.visitors | keyvalue: firstVisitOrder">
              {{visitorPair.value.athlete.name}} - {{visitorPair.value.visits.length}} visits since {{visitorPair.value.firstVisit()}} with PB {{visitorPair.value.pb()}}
            </li>
            <br />
            <p><a href="{{mappedEvent.event.url}}" target='_parkrun'>Visit event website.</a></p>
          </div>
        </agm-info-window>
      </agm-marker>
    </agm-map>
    <button class="map-settings" (click)="this.showSettings()">Map Settings</button>
</div>